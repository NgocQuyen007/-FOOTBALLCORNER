var deleteImage,MatchFindingHelper;sportApp.controller("NotificationCtrl",["$scope","$firebaseObject","$rootScope","NotificationService",function(n,t,i,r){n.notiItemListObj=[];n.notiItemListDisplay=[];n.notiItemCount="";n.onShowed=!1;n.notiRef=null;n.pageIndex=1;n.pageSize=25;n.notiItemHistoryList=[];n.notiHistoryLoaded=!1;n.loadNotificationHistory=function(t,i){t&&(n.pageIndex=t);i&&$(i.toElement).button("loading");r.getNotificationHistory(n.pageIndex,n.pageSize).then(function(t){t.isSuccessful&&(n.notiItemHistoryList=n.notiItemHistoryList.concat(t.data),n.hasMoreData=t.data.length>=n.pageSize);n.notiHistoryLoaded=!0;i&&$(i.toElement).button("reset")})};n.onLoadNotifications=function(){n.notiRef=(new firebase.database).ref("notifications/"+global.authen.getUserID());n.notiRef.limitToLast(5).on("value",function(t){var i=t.val(),r=n.$$phase;r!="$apply"&&r!="$digest"?n.$apply(function(){n.notiItemListObj=i==null?[]:i;n.calculateNotiItemCount()}):(n.notiItemListObj=i==null?[]:i,n.calculateNotiItemCount());n.onShowed=!1;n.isNotificationLoaded=!0})};n.calculateNotiItemCount=function(){var u,i,t;n.notiItemListDisplay=[];common.ui.notificationHubs.close();var f=[],e=[],r=0,o=Object.keys(n.notiItemListObj);for(u=0;u<o.length;u++)i=n.notiItemListObj[o[u]],i.image&&(i.image=i.image.replace("http://","https://")),t=jQuery.extend(!0,{},i),t.url=n.getNotiUrl(i.itemType,i.itemId),e.push(t),t.isRead==!1&&(r++,$.inArray(t,f)==-1&&f.length<=5&&(f.push(t),common.ui.notificationHubs.show(t.title,t.content,t.image,t.url)));n.notiItemCount=r==0?"":r>=5?"5+":r;n.notiItemListDisplay=e};n.onShowNotifications=function(){var i,t,r;if(n.onShowed||n.notiItemCount.length==0)return!1;for(common.ui.notificationHubs.close(),n.notiItemCount="",i=Object.keys(n.notiItemListObj),t=0;t<i.length;t++)r=n.notiItemListObj[i[t]],r.isRead=!0;n.notiRef.update(n.notiItemListObj);n.onShowed=!0};n.calTimeAgo=function(n){return calcuateTimeAgo(n)};n.getNotiUrl=function(n,t){var r="javascript:void();";switch(n){case common.config.notificationItemType.matchRecipient_PartnerCreate:case 20:r=i.getMatchFindingOnPageUrl(t);break;case common.config.notificationItemType.matchRecipient_PartnerCancel:r=i.getMatchFindingOnPageUrl(t);break;case common.config.notificationItemType.matchRecipient_OwnerCancel:r=i.getMatchFindingOnPageUrl(t);break;case common.config.notificationItemType.matchRecipient_OwnerConfirm:r=i.getMatchFindingOnPageUrl(t);break;case common.config.notificationItemType.requestApproveBooking:r=i.getReviewBookingListingUrl(t,n);break;case common.config.notificationItemType.responseApproveBooking:r=i.getReviewBookingListingUrl(t,n);break;case common.config.notificationItemType.requestApproveRepeatBooking:r=i.getReviewBookingListingUrl(t,n);break;case common.config.notificationItemType.responseApproveRepeatBooking:r=i.getReviewBookingListingUrl(t,n)}return r};global.authen.isAuthenticated()&&n.onLoadNotifications()}]);sportApp.controller("StadiumBookingNotificationCtrl",["$scope","$http","$timeout","$interval","StadiumService","StadiumBookingService","CommonService","orderByFilter",function(n,t,i,r,u,f){n.bookingRequestsCount=0;n.loadPendingBookings=function(){f.getPendingBooking().then(function(t){n.bookingRequests=t.data;n.bookingRequestsCount=t.data!=null?t.data.length:0})};n.loadPendingBookings()}]);sportApp.controller("stadiumCtrl",["$scope","$http","$timeout","$interval","StadiumService","StadiumBookingService","CommonService","orderByFilter",function(n,t,i,r,u,f){n.bookingRequestsCount=0;n.filter={typeId:1,provinceId:3,searchText:""};n.onInit=function(){common.ui.showLoading();n.overlayLoading=!0;location.hash.toLocaleLowerCase()=="#/booking"?n.loadPendingBookings():(n.loadPendingBookings(),n.loadStadiumList())};n.loadStadiumList=function(){common.ui.showLoading();n.overlayLoading=!0;u.getListStadium(n.filter).then(function(t){n.stadiums=t.stadiums;n.overlayLoading=!1;common.ui.hideLoading()})};n.loadPendingBookings=function(t){t||common.ui.showLoading();f.getPendingBooking().then(function(t){n.bookingRequests=t.data;n.bookingRequestsCount=t.data!=null?t.data.length:0;location.hash.toLocaleLowerCase()=="#/booking"&&(document.title="Yêu cầu đặt sân ("+n.bookingRequestsCount+")");common.ui.hideLoading();n.overlayLoading=!1})};n.onInit();n.changeStatus=function(i,r,u){confirm(u.currentTarget.attributes["confirmation-needed"].value)&&(common.ui.showLoading(),n.stadiumId=i,n.status=r,t.post("/ajax/stadium/changestatus?stadiumId="+i+"&status="+r).success(function(t){var r;if(common.ui.hideLoading(),t.isSuccess==!0){if(t.status=="deleted"){for(r=0;r<n.stadiums.length;r++)if(n.stadiums[r].Id==i){n.stadiums=$.grep(n.stadiums,function(t){return t!=n.stadiums[r]});return}}else for(r=0;r<n.stadiums.length;r++)if(n.stadiums[r].Id==n.stadiumId){n.stadiums[r].Status=n.status;return}typeof t.message!="undefined"&&t.message!=""&&alert(t.message)}}).error(function(t,i,r,u){n.isFormLoading=!1;alert("Error while delete stadium, please refresh your browser and try again");console.log(i);console.log(t);console.log(r);console.log(u)}))};n.backToListStadium=function(){$("#listStadium").removeClass("hidden");$("#addOrEditStadium").addClass("hidden")};n.approveBookingRequest=function(t,i){confirm("Bạn chắc chắn muốn duyệt yêu cầu đặt sân này?")&&(common.ui.showLoading(),$(t.toElement).button("loading"),f.approveBooking(i.bookingId).then(function(){common.ui.showLoading();$(t.toElement).button("reset");common.ui.notification.success("Yêu cầu "+i.bookingTitle+" đã được duyệt !");n.loadPendingBookings()}))};n.rejectBookingRequest=function(t,i){confirm("Bạn chắc chắn muốn hủy yêu cầu đặt sân này?")&&(common.ui.showLoading(),$(t.toElement).button("loading"),f.rejectBooking(i.bookingId).then(function(){common.ui.showLoading();$(t.toElement).button("reset");common.ui.notification.success("Yêu cầu "+i.bookingTitle+" đã được hủy !");n.loadPendingBookings()}))}}]).controller("stadiumInfoCtrl",["$scope","$http","$timeout","$interval","StadiumService","StadiumBookingService","CommonService","orderByFilter","$routeParams","ImageUpload",function(n,t,i,r,u,f,e,o,s,h){function p(){var t=angular.copy(n.stadiumTypeBySize);return angular.forEach(n.stadiumNumberRows,function(i,r){r!=n.stadiumNumberRows&&(t=t.filter(function(n){return n.id!==i.selectedStadiumTypeBySize.id}))}),t}function a(){setTimeout(function(){$(".textbox-timepicker").datetimepicker2({datepicker:!1,format:"H:i",allowTimes:["16:00","16:30","17:00","17:30","18:00","18:30","19:00","19:30","20:00","20:30","5:00","5:30","6:00","6:30","7:00","7:30","8:00","8:30","9:00","9:30","10:00","10:30","14:00","14:30","15:00","15:30","21:00","21:30","22:00","22:30","23:00","23:30"]})},500)}function v(){$("#stadium-about").summernote({height:160,toolbar:[["style",["bold","italic","underline"]],["para",["ul","ol","paragraph"]],["color",["color"]],["insert",["picture","link","video","table"]]]})}var l=parseInt(s.stadiumId),y=parseInt(s.isSuccess),c;for(n.stadiumId=l,n.typeId=parseInt(s.typeId),(typeof n.typeId==undefined||n.typeId==0)&&(n.typeId=1),n.detailTitle="",n.detailTitle=n.typeId==1?"Thêm sân bóng mới":n.typeId==2?"Thêm sân Tennis mới":n.typeId==3?"Thêm sân Bóng chuyền mới":n.typeId==4?"Thêm sân Bóng bàn mới":n.typeId==5?"Thêm sân Cầu Lông mới":n.typeId==6?"Thêm bể bơi mới":"Thông tin cơ bản",n.typeList=[{id:"1",name:"Bóng đá"},{id:"2",name:"Tennis"},{id:"3",name:"Bóng chuyền"},{id:"4",name:"Bóng bàn"},{id:"5",name:"Cầu Lông"},{id:"6",name:"Bơi lội"}],n.stadiumTypeBySize=[{id:5,name:"5 người"},{id:7,name:"7 người"},{id:9,name:"9 người"},{id:11,name:"11 người"}],n.stadiumNumberRows=[],n.stadiumNumbers=[],n.form={},n.additionalSN={availableSizes:n.stadiumTypeBySize},n.$watch("stadiumNumberRows",function(){n.additionalSN.availableSizes=p();n.additionalSN.availableSizes.length>0&&(n.additionalSN.selectedSize=n.additionalSN.availableSizes[0])}),c=0;c<n.typeList.length;c++)if(parseInt(n.typeList[c].id)==n.typeId){n.selectedType=n.typeList[c];break}n.hasStadiumNumber=!1;n.stadiumNumberEmpty=!1;n.isCreate=!0;n.onInit=function(){waitingDialog.show("Đang tải dữ liệu sân");isNaN(l)||l<=0?(n.isCreate=!0,n.initAddNewStadium()):(n.isCreate=!1,n.initEditStadium(l));y==1&&(n.showUpdateResults=!0,n.showErrorMessage=!1,n.showSuccessMessage=!0)};n.filterMediaHtml=function(n){n!=null&&n.length>0&&($(".gallery").html(""),$.each(n,function(n,t){var i="<a class='mediaItem'>";i+=['<img class="thumb" src="',t.FilePath,'" title="',"",'"/>'].join("");i+="<img src='/Assets/img/icon-delete.jpg' onclick='deleteImage(this)' class='icon-delete'/>";i+="<input type='hidden' name='FilePath' value='"+t.FilePath+"'/>";i+="<input type='hidden' name='Id' value='"+t.Id+"'/>";i+="<\/a>";$(".gallery").append(i)}))};n.uploadProfile=function(){$("#fileuploader").uploadFile({url:"/ajax/stadium/uploadprofile'",fileName:"profileUpload",returnType:"json",onSuccess:function(n,t){if(t!=null&&t.isUploaded==!0){var i="<a class='mediaItem'>";i+=['<img class="thumb" src="',t.path,'" title="',"",'"/>'].join("");i+="<img src='/Assets/img/icon-delete.jpg'onclick='deleteImage(this)' class='icon-delete'/>";i+="<input type='hidden' name='FilePath' value='"+t.path+"'";i+="<\/a>";$(".gallery").append(i)}},onError:function(){}})};n.changeStadiumNumberQuantity=function(n){var t=prompt("Mời bạn nhập số lượng sân",n.quantity);if(t!=null&&t!==""){if(isNaN(t)||parseInt(t)>30){alert("Dữ liệu không hợp lệ. Bạn phải nhập số <30");return}n.quantity=t}};n.saveChange=function(t){n.loadingOverlay=!0;common.ui.showLoading();$(t.toElement).button("loading");n.showErrorMessage=!1;n.showSuccessMessage=!1;n.form.TypeId=n.form.selectedType.id;n.form.StadiumTypeId=n.form.selectedStadiumType!=null?n.form.selectedStadiumType.Value:0;n.form.ProvinceId=n.form.selectedProvince.Id;n.form.CountyId=n.form.selectedCounty.Id;n.form.Longitude=$("#longitude").val().replace(/\./g,",");n.form.Latitude=$("#latitude").val().replace(/\./g,",");n.form.AvailableStadiumNumbers=[];n.form.Images=[];n.form.About=$("#stadium-about").summernote("code");$.each($(".mediaItem"),function(t,i){var r={},f=$(i).find("input[name='FilePath']"),u;typeof f!="undefined"&&(r.FilePath=f.val());u=$(i).find("input[name='Id']");r.Id=typeof u!="undefined"?u.val():0;n.form.Images.push(r)});var i=angular.copy(n.stadiumNumberRows),r=i.length;n.stadiumNumberEmpty=i.length==0?!0:!1;angular.forEach(i,function(t){var i={},r;i.NumberOfPlayers=t.selectedStadiumTypeBySize.id;i.Quantity=t.quantity;i.AvailablePrices=[];i.GroupedIds=t.groupedIds;r=t.stadiumNumberPrices.length;angular.forEach(t.stadiumNumberPrices,function(n){angular.forEach(n.selectedTimeGroups,function(t){var r={};r.Code=t.Value;r.StartTime=n.startTime;r.EndTime=n.endTime;r.Price=n.price;i.AvailablePrices.push(r)})});n.form.AvailableStadiumNumbers.push(i)});u.saveChange(n.form).then(function(i){$(".item-card").removeClass("disabledContainer");$("#btnUpdateStadium").html("Lưu thay đổi");$("#btnCreateStadium").html("Thêm mới");n.showUpdateResults=!0;typeof i.isSuccess!="undefined"&&i.isSuccess==!0?(n.showSuccessMessage=!0,n.showErrorMessage=!1,i.isCreate&&(n.hasStadiumNumber=!0,n.stadiumId=i.stadium.Id,n.showSuccessMessage=!0,location.href="#/stadium-info/"+i.stadium.Id),n.initEditStadium(i.stadium.Id),n.stadiumNumbers=i.stadium.UngroupedAvailableStadiumNumbers,n.isCreate=!1):(n.showErrorMessage=!0,n.showSuccessMessage=!1);common.ui.hideLoading();n.loadingOverlay=!1;$(t.toElement).button("reset")})};n.deleteStadiumNumber=function(i,r,u){confirm(u.currentTarget.attributes["confirmation-needed"].value)&&(common.ui.showLoading(),t({method:"POST",url:"/ajax/stadiumnumber/delete",data:{stadiumId:n.stadiumId,stadiumNumberIds:[i]}}).success(function(t){if(common.ui.hideLoading(),t.isSuccess==!0){common.ui.notification.success("Xóa thành công sân "+n.stadiumNumbers[r].Name);n.stadiumNumbers.splice(r,1);var u=!0;angular.forEach(n.stadiumNumberRows,function(t,r){$.inArray(i,t.groupedIds)>-1&&u&&(t.quantity=t.quantity-1,t.quantity<=0&&n.stadiumNumberRows.splice(r,1),u=!1)})}else typeof t.message!="undefined"&&t.message!=""&&common.ui.notification.error(t.message)}).error(function(t,i,r,u){n.isFormLoading=!1;common.ui.notification.error("Error while delete stadium, please refresh your browser and try again");console.log(i);console.log(t);console.log(r);console.log(u)}))};n.initAddNewStadium=function(){n.isCreate=!0;waitingDialog.show("Đang tải dữ liệu sân");n.showErrorMessage=!1;n.showSuccessMessage=!1;$(".note-editable").html("");$("#profile-avatar").attr("src","");u.initCreateStadium().then(function(t){var i,r,u;n.form={};n.form.selectedType=n.selectedType;n.stadiumTypes=t.stadiumTypes;n.provinces=t.provinces;n.stadium=t.stadium;n.currentTimeFrames=t.currentTimeFrames;n.form.selectedProvince=t.selectedProvince;n.form.selectedStadiumType=n.stadiumTypes[0];n.form.selectedCounty=t.selectedProvince.Children[0];n.form.PicturePath="";n.defaultStadiumNumberPrice={timeGroups:t.timeGroups,timeFrames:t.timeFrames,price:0,isEditMode:!0,selectedTimeGroups:[]};n.additionalPrice={timeGroups:t.timeGroups,timeFrames:t.timeFrames,price:0,selectedTimeGroups:[]};i=angular.copy(n.defaultStadiumNumberPrice);r=[];r.push(i);u={selectedStadiumTypeBySize:n.stadiumTypeBySize[0],stadiumTypeBySize:angular.copy(n.stadiumTypeBySize),quantity:1,stadiumNumberPrices:r,groupedIds:[]};n.stadiumNumberRows=[];n.typeId!=1&&(n.stadiumNumberRows.push(u),n.reinitTimeGroup(i.timeGroups));waitingDialog.hide();v();$(".select2-enabled").select2();a()})};n.initMap=function(){common.ui.modal.show("mapModal");$("#ddlMapSelectedProvince, #ddlMapSelectedCounty").select2();setTimeout(function(){myLatlng=new google.maps.LatLng(21.026939,105.833358);initialize_map()},1e3)};n.searchMap=function(){var n="",t=$("#ddlMapSelectedProvince option:selected").text(),i=$("#ddlMapSelectedCounty option:selected").text(),r=$("#txtMapAddress").val(),u;r&&(n+=r);i!=""&&(n+="+"+i);t!=""&&(n+="+"+t);n==""&&(n="Hà Nội");u="https://maps.googleapis.com/maps/api/geocode/json?address="+n;$.support.cors=!0;$.ajax({url:u,type:"POST",timeout:3e4,dataType:"json",success:function(n){if(n!=null&&n.results!=null&&n.results.length>0&&n.status=="OK"){var t=n.results[0].geometry.location;myLatlng=new google.maps.LatLng(t.lat,t.lng);initialize_map();$(".lat").html(t.lat);$(".long").html(t.lng)}},error:function(n,t,i){console.log(t+","+i+","+n.responseText)}})};n.selectMap=function(){n.form.Latitude=$(".lat").html();n.form.Longitude=$(".long").html();common.ui.modal.hide("mapModal")};n.uploadProfile();n.initEditStadium=function(t){n.isCreate=!1;n.hasStadiumNumber=!0;n.showErrorMessage=!1;n.showSuccessMessage=!1;u.initEditStadium(t).then(function(t){n.defaultStadiumNumberPrice={timeGroups:t.timeGroups,timeFrames:t.timeFrames,price:0,isEditMode:!0,selectedTimeGroups:[]};n.stadiumNumbers=t.stadium.UngroupedAvailableStadiumNumbers;n.form={};n.map={};n.stadiumTypes=t.stadiumTypes;n.provinces=t.provinces;n.form=t.stadium;n.filterMediaHtml(n.form.Images);n.form.selectedProvince=t.selectedProvince;n.map.selectedProvince=angular.copy(n.form.selectedProvince);n.form.selectedStadiumType=n.stadiumTypes[0];n.form.selectedCounty=t.selectedCounty;n.map.selectedCounty=angular.copy(n.form.selectedCounty);n.currentTimeFrames=t.currentTimeFrames;document.title="Quản lý sân - "+t.stadium.Name;v();$("#stadium-about").summernote("code",t.stadium.About);n.stadiumNumberRows=[];angular.forEach(n.form.AvailableStadiumNumbers,function(t){var r={},u=angular.copy(n.stadiumTypeBySize),f=!0,i,e;angular.forEach(u,function(n){f==!0&&n.id==t.NumberOfPlayers&&(r=n,f=!1)});i=[];angular.forEach(t.AvailablePrices,function(t){var r={selectedTimeFrame:t.SelectedTimeFrame,timeGroups:n.defaultStadiumNumberPrice.timeGroups,timeFrames:n.defaultStadiumNumberPrice.timeFrames,price:t.Price,startTime:t.StartTime,endTime:t.EndTime,selectedTimeGroups:t.SelectedTimeGroups,selectedTimeGroupsText:t.SelectedTimeGroupsText,groupedIds:t.GroupedIds,isEditMode:!1};i.push(r)});e={selectedStadiumTypeBySize:r,stadiumTypeBySize:u,quantity:t.Quantity,groupedIds:t.GroupedIds,stadiumNumberPrices:i};n.stadiumNumberRows.push(e)});n.reInitStadiumTypeBySizeDropdown();$.each(n.typeList,function(i,r){if(r.id==t.stadium.TypeId){n.form.selectedType=r;n.selectedType=r;return}});n.reinitTimeGroup();waitingDialog.hide();$(".select2-enabled").select2();a()})};n.removeStadiumNumberRow=function(i,r){if(i.groupedIds==null||i.groupedIds.length==0){var u=angular.copy(n.stadiumNumberRows[r]);n.stadiumNumberRows.splice(r,1);angular.forEach(n.stadiumNumberRows,function(n){n.stadiumTypeBySize.push(u.selectedStadiumTypeBySize);n.stadiumTypeBySize=o(n.stadiumTypeBySize,"id",!1)})}else confirm("Bạn có chắc chắn muốn xóa sân con này?")&&(common.ui.showLoading(),n.loadingOverlay=!0,t({method:"POST",url:"/ajax/stadiumnumber/delete",data:{stadiumId:n.stadiumId,stadiumNumberIds:i.groupedIds}}).success(function(t){var f,u;t.isSuccess==!0?(f=angular.copy(n.stadiumNumberRows[r]),n.stadiumNumberRows.splice(r,1),angular.forEach(n.stadiumNumberRows,function(n){n.stadiumTypeBySize.push(f.selectedStadiumTypeBySize);n.stadiumTypeBySize=o(n.stadiumTypeBySize,"id",!1)}),u=[],angular.forEach(n.stadiumNumbers,function(n){$.inArray(n.Id,i.groupedIds)==-1&&u.push(n)}),n.stadiumNumbers=u,common.ui.notification.success("Xóa thành công sân "+i.selectedStadiumTypeBySize.name)):typeof t.message!="undefined"&&t.message!=""&&common.ui.notification.error(t.message);common.ui.hideLoading();n.loadingOverlay=!1}).error(function(t,i,r,u){common.ui.hideLoading();n.loadingOverlay=!1;common.ui.notification.error("Error while delete stadium, please refresh your browser and try again");console.log(i);console.log(t);console.log(r);console.log(u)}));n.stadiumNumberRows=angular.copy(n.stadiumNumberRows)};n.addStadiumNumberRow=function(){var t={selectedStadiumTypeBySize:n.additionalSN.selectedSize,stadiumTypeBySize:n.additionalSN.availableSizes,quantity:n.additionalSN.quantity,timeFramePrices:angular.copy(n.currentTimeFrames),id:0,isEditMode:!0,stadiumNumberPrices:[angular.copy(n.defaultStadiumNumberPrice)],groupedIds:[]};n.stadiumNumberRows.push(t);n.reinitTimeGroup(t.stadiumNumberPrices[0].timeGroups);n.stadiumNumberRows=angular.copy(n.stadiumNumberRows);a()};n.reInitStadiumTypeBySizeDropdown=function(){angular.forEach(n.stadiumNumberRows,function(t){angular.forEach(n.stadiumNumberRows,function(n){n!=t&&(t.stadiumTypeBySize=t.stadiumTypeBySize.filter(function(t){return t.id!==n.selectedStadiumTypeBySize.id}))})})};n.addStadiumNumberPrice=function(t){var r=n.stadiumNumberRows[t],i=angular.copy(n.defaultStadiumNumberPrice);i.isEditMode=!0;r.stadiumNumberPrices.push(i);n.reinitTimeGroup(i.timeGroups);a()};n.editStadiumNumberPrice=function(t,i){var r=n.stadiumNumberRows[t];r.stadiumNumberPrices[i].isEditMode=!0;r.stadiumNumberPrices[i].isEditing=!0;n.reinitTimeGroup(r.stadiumNumberPrices[i].timeGroups)};n.removeStadiumNumberPrice=function(i,r){var u=n.stadiumNumberRows[i],f,e;typeof u.stadiumNumberPrices[r].groupedIds!="undefined"&&u.stadiumNumberPrices[r].groupedIds.length!=0?(f=u.stadiumNumberPrices[r].groupedIds,e=u.stadiumNumberPrices[r].price,confirm("Bạn có muốn chắc chắn xóa bảng giá này")&&t({method:"POST",url:"/stadium/price/delete",data:{stadiumId:n.stadiumId,stadiumNumberPriceIds:f}}).success(function(t){t.isSuccess==!0?(u.stadiumNumberPrices.splice(r,1),common.ui.notification.success("Cập nhật thành công.")):common.ui.notification.error("Có lỗi xảy ra trong quá trình xử lý yêu cầu,vui lòng tải lại trang và thử lại");common.ui.showLoading();n.loadingOverlay=!1}).error(function(t,i,r,u){common.ui.notification.error("Có lỗi xảy ra trong quá trình xử lý yêu cầu,vui lòng tải lại trang và thử lại");console.log(i);console.log(t);console.log(r);console.log(u);common.ui.showLoading();n.loadingOverlay=!1})):u.stadiumNumberPrices.splice(r,1)};n.reinitTimeGroup=function(){setTimeout(function(){$(".selectpicker").selectpicker()})};n.initEditStadiumNumber=function(t){n.stadiumNumberModel=angular.copy(t);common.ui.modal.show("modalEditStadiumNumber")};n.storeStadiumNumber=function(){common.ui.showLoading();t({method:"POST",url:"/ajax/stadiumnumber/save",data:{stadiumNumberModel:n.stadiumNumberModel}}).success(function(t){if(common.ui.hideLoading(),t.isSuccess==!0){var i=!0;angular.forEach(n.stadiumNumbers,function(t){t.Id==n.stadiumNumberModel.Id&&i&&(t.Name=n.stadiumNumberModel.Name,i=!1)});common.ui.modal.hide("modalEditStadiumNumber");common.ui.notification.success("Cập nhật thành công.")}else common.ui.notification.error("Có lỗi xảy ra trong quá trình xử lý yêu cầu,vui lòng tải lại trang và thử lại")}).error(function(t,i,r,u){n.isFormLoading=!1;common.ui.notification.error("Có lỗi xảy ra trong quá trình xử lý yêu cầu,vui lòng tải lại trang và thử lại");console.log(i);console.log(t);console.log(r);console.log(u)})};$("#previewImagePath").change(function(){setTimeout(function(){n.uploadPreviewPicture()},100)});n.uploadPreviewPicture=function(){common.ui.showLoading();h.uploadToUrl(n.imageLogo).then(function(t){t.link!=""&&(n.form.PicturePath=t.link);common.ui.hideLoading()})};n.onInit()}]);deleteImage=function(n){var t=$(n).closest(".mediaItem"),i=t.find("input[name='Id']").val();typeof i=="undefined"||i==""?$(t).remove():(common.ui.showLoading(),$.ajax({url:"/stadium/deleteImage",type:"POST",data:{mediaItemId:i},success:function(n){common.ui.hideLoading();n.isSuccess==!0?$(t).remove():common.ui.notification.error("Có lỗi xảy ra trong quá trình xử lý yêu cầu,vui lòng tải lại trang và thử lại")},error:function(){common.ui.hideLoading();common.ui.notification.error("Có lỗi xảy ra trong quá trình xử lý yêu cầu,vui lòng tải lại trang và thử lại")}}))};sportApp.controller("StadiumBookingManager",["$scope","$http","$routeParams","$timeout","$interval","StadiumService","StadiumBookingService","CommonService","orderByFilter",function(n,t,i,r,u,f,e){function o(n,t,i,r){return{bookingId:0,stadiumId:n.stadiumId,stadiumNumberId:n.stadiumNumberId,stadiumNumberName:n.stadiumNumberName,date:t,startHour:i,endHour:r}}function s(){setTimeout(function(){$(".textbox-timepicker").datetimepicker2({datepicker:!1,format:"H:i"})},100)}n.stadiumId=parseInt(i.stadiumId);n.bookingDates=[];n.stadiumNumbers=[];n.isInProgress=!0;n.startDate=moment(new Date).format("YYYY-MM-DD");n.endDate=moment(new Date).format("YYYY-MM-DD");n.onDeleteBookingRecord={};common.ui.showLoading();f.getStadiumInfo(n.stadiumId).then(function(t){n.stadium=t.data;common.ui.hideLoading()});n.loadBookingDates=function(){common.ui.showLoading();n.isInProgress=!0;e.getBookingDates(n.stadiumId,n.startDate,n.endDate).then(function(t){n.bookingDates=t.data;n.bookingDates[0].isVisible=!0;n.stadiumNumbers=t.data[0].timeFrames[0].bookingRecords;s();common.ui.hideLoading();n.isInProgress=!1})};n.loadTodayBookingDates=function(){n.startDate=moment(new Date).format("YYYY-MM-DD");n.endDate=moment(new Date).format("YYYY-MM-DD");n.loadBookingDates()};n.saveBooking=function(t,i,r,u){var f=n.bookingDates[i].timeFrames[r].bookingRecords[u];if(f.userName==null||f.userName==""){alert("Bạn chưa nhập tên đội / người đặt sân!");return}if(f.userMobile==null||f.userMobile==""){alert("Bạn chưa nhập số điện thoại người đặt");return}common.ui.hideLoading();$(t.toElement).button("loading");e.createBooking({bookingRecord:f}).then(function(f){f.isSuccessful?(n.bookingDates[i].timeFrames[r].bookingRecords[u]=f.data,common.ui.notification.success("Cập nhật thành công.")):typeof f.errors!="undefined"&&f.errors.length>0?common.ui.notification.error(f.errors[0].message):common.ui.notification.error("Có lỗi xảy ra trong quá trình xử lý yêu cầu, vui lòng tải lại trang hoặc liên hệ với quản trị website");n.bookingDates[i].timeFrames[r].bookingRecords[u].isEditing=!1;common.ui.hideLoading();$(t.toElement).button("reset")})};n.onDeleteBooking=function(t,i,r){var u=n.bookingDates[t].timeFrames[i].bookingRecords[r];u.isRepeat&&u.bookingId>0?(n.onDeleteBookingRecord=u,n.onDeleteBookingRecord.isCancelRepeatDate="1",n.onDeleteBookingRecord.dateIndex=t,n.onDeleteBookingRecord.timeFrameIndex=i,n.onDeleteBookingRecord.bookingRecordIndex=r,n.onDeleteBookingRecord.date=n.bookingDates[t].date,common.ui.modal.show("modalDeleteRepeatBookingConfirmation")):confirm("Bạn chắc chắn muốn xóa lịch này?")&&(common.ui.showLoading(),n.deleteBooking(t,i,r))};n.deleteBooking=function(t,i,r){var u=n.bookingDates[t].timeFrames[i].bookingRecords[r];e.deleteBooking(u.bookingId,u.isCancelRepeatDate==1,u.date).then(function(f){f.isSuccessful?n.bookingDates[t].timeFrames[i].bookingRecords[r]=o(u,u.date,u.startHour,u.endHour):typeof f.errorMessage!="undefined"?common.ui.notification.error(f.errorMessage):common.ui.notification.error("Có lỗi xảy ra trong quá trình xử lý yêu cầu, vui lòng tải lại trang hoặc liên hệ với quản trị website");common.ui.hideLoading()})};n.deleteBookingRepeat=function(t){$(t.toElement).button("loading");common.ui.showLoading();var i=n.onDeleteBookingRecord,r=i.dateIndex,u=i.timeFrameIndex,f=i.bookingRecordIndex;e.deleteBooking(i.bookingId,i.isCancelRepeatDate==1,i.date).then(function(e){e.isSuccessful?(n.bookingDates[r].timeFrames[u].bookingRecords[f]=o(i,i.date,i.startHour,i.endHour),common.ui.modal.hide("modalDeleteRepeatBookingConfirmation")):typeof e.errorMessage!="undefined"?common.ui.notification.error(e.errorMessage):common.ui.notification.error("Có lỗi xảy ra trong quá trình xử lý yêu cầu, vui lòng tải lại trang hoặc liên hệ với quản trị website");$(t.toElement).button("reset");common.ui.hideLoading()})};n.addTimeFrame=function(t){var i=n.bookingDates[t],r;if(i.startTimeOfDayNew==null||i.startTimeOfDayNew==""||i.endTimeOfDayNew==null||i.endTimeOfDayNew==null){alert("Bạn cần chọn khung giờ");return}var u=i.startTimeOfDayNew,f=i.endTimeOfDayNew,e={startTimeOfDay:u,endTimeOfDay:f,name:u+" - "+f,bookingRecords:[]};for(r=0;r<n.bookingDates[t].timeFrames[0].bookingRecords.length;r++)e.bookingRecords.push(o(n.bookingDates[t].timeFrames[0].bookingRecords[r],i.date,u,f));i.timeFrames.push(e)};n.loadBookingDates()}]);sportApp.controller("UserCommentController",["$scope","$http","$timeout","$interval","CommentService",function(n,t,i,r,u){function f(n,t){for(var i in n)if(n[i].id==t)return n[i];return null}function e(){return{toItemId:n.toItemId,toItemType:n.toItemType,toUserId:n.toUserId,toTeamId:n.toTeamId,message:n.commentPost.message}}n.commentAuthor={userId:common.config.userId,avatar:common.config.avatar!==""?common.config.avatar:"/Images/user/default-user.png",userName:common.config.name};n.recipientStatusList=common.config.matchRecipientStatuss;n.loadComments=function(t,i,r,f){n.toItemId=i;n.toItemType=t;n.toUserId=r;n.toTeamId=f;u.getList(t,i).then(function(t){n.commentList=t.data;addDOMEvents()})};n.showHtml=function(n){return n.replace(/(?:\r\n|\r|\n)/g,"<br />")};n.addNewComment=function(){var t=e();n.addComment(t,function(){n.commentPost.message=""})};n.addComment=function(t,i){common.ui.showLoading();u.add(t).then(function(t){var r=t.data,u;r.parentId>0?(u=f(n.commentList,r.parentId),u.children.push(r),u.relatedItemStatus=r.relatedItemStatus,u.relatedItemStatusText=r.relatedItemStatusText,u.extraIconCssClass=r.extraIconCssClass):n.commentList.push(r);i&&i();common.ui.hideLoading()})};n.onReply=function(t){if(!global.authen.isAuthenticated()){global.showModalNotAuthorize();return}common.ui.showLoading();u.getReplyModel(t.id).then(function(i){if(t.reply=i.data,t.reply.confirmMatchInvitionEnabled){var r=t.reply.relatedItemStatus;r==5&&(r=1);t.reply.selectedRelatedItemStatus=f(n.recipientStatusList,r)}common.ui.hideLoading()})};n.addCommentReply=function(t){if(t.reply.confirmMatchInvitation&&t.reply.relatedItemStatus){var i=t.reply.relatedItemStatus==2?"Đồng ý":"Từ chối";if(!confirm("Bạn có chắc chắn "+i+" đối tác này?")){t.reply.relatedItemStatus=null;return}}t.reply.confirmMatchInvitionEnabled&&(t.reply.relatedItemStatus=t.reply.selectedRelatedItemStatus.id);n.addComment(t.reply,function(){t.reply=null})};n.checkAuthentication=function(){if(console.log("called checkAuthentication!"),!global.authen.isAuthenticated()){global.showModalNotAuthorize();return}}}]);MatchFindingHelper={onSearchStadiumSelectedChange:function(){console.log("onSearchStadiumSelectedChange")}};sportApp.controller("matchFindingCtrl",["$scope","$rootScope","CommonService","MatchFindingService","StadiumService","$compile",function(n,t,i,r,u){function f(n,t,i,u){$(n.toElement).button("loading");common.ui.showLoading();r.confirmMatchInvitation(t,i,u).then(function(){$(n.toElement).button("reset");common.ui.hideLoading();common.ui.notification.success("Xác nhận đối thành công");setTimeout(function(){location.reload()},1e3)})}n.filter={};n.filter.teamId=0;n.filter.typeId=1;n.filter.pageIndex=1;n.filter.pageSize=30;n.filter.countryId=1;n.filter.provinceId="3";n.filter.ageGroupIds=[];n.filter.countyIds=[];n.filter.stadiumIds=[];n.filter.levelIds=[];n.filter.startTime=null;n.filter.endTime=null;n.listMatchFindingRequest=[];n.countryId=1;n.listAgeGroups=[];n.listLevels=[];n.listProvinces=[];n.listCounties=[];n.listStadiums=[];n.myLeadTeams=t.getMyLeadTeams();n.myLeadTeams.length>0&&(n.matchFindingRecipient={teamId:n.myLeadTeams[0].Id});n.isSearchingMatchFindingRequests=!0;n.loadCounties=function(t){i.getAllCounties(t).then(function(t){n.listCounties=t.records})};n.loadStadiums=function(){var t={provinceId:n.filter.provinceId,key:"",countyIdList:n.filter.countyIds,sportType:n.filter.typeId};u.searchStadiums(t).then(function(t){n.listStadiums=t.records})};n.searchMatchFindingRequests=function(){common.ui.showLoading();n.isSearchingMatchFindingRequests=!0;r.searchMatchFindingRequest(n.filter).then(function(t){n.listMatchFindingRequest=t.records;common.ui.hideLoading();n.isSearchingMatchFindingRequests=!1})};n.acceptMatchInvitation=function(n,t,i){confirm("Đội bạn chắc chắn tham gia được trận này?")&&f(n,t,i,2)};n.rejectMatchInvitation=function(n,t,i){confirm("Đội bạn chắc chắn Không muốn tham gia trận này?")&&f(n,t,i,3)};n.isShowFilter=!0;n.toggleFilter=function(){n.isShowFilter=!n.isShowFilter}}]).controller("matchFindingConfirmCtrl",["$scope","MatchFindingService","$routeParams","CommonService",function(n){n.matchFindingRequestId=common.config.matchFindingId;n.matchFindingMapping={matchFindingRecipient:{toUserPhone:common.config.toUserPhone}};n.isShowActionCancelMatch=function(){var t=n.getMatchFindingStatus();return t===1&&n.matchFindingMapping.matchFinding.isUserAuthorizedToManageMatch};n.isShowRecipientInfo=function(){return n.matchFindingMapping.matchFindingRecipient!==null};n.isShowActionConfirmOwner=function(){var t=n.getMatchFindingStatus();return t===1&&n.matchFindingMapping.matchFinding.isUserAuthorizedToManageMatch&&n.isShowRecipientInfo()};n.isShowActionConfirmPartner=function(){var t=n.getMatchFindingStatus();return t===1&&n.isShowRecipientInfo()&&n.matchFindingMapping.matchFinding.isUserAuthorizedToManageRecipient};n.isConfirmedRecipient=function(){var t=n.getMatchFindingStatus();return t===2};n.isCancelMatchFinding=function(){var t=n.getMatchFindingStatus();return t===3};n.loadMatchFindingConfirm()}]).controller("testConsoleCommandCtrl",["$scope","TeamService","$routeParams","CommonService","$http",function(n,t,i,r,u){n.runMapping=function(){n.runCmd("mapping")};n.runNotification=function(){n.runCmd("notification")};n.runCleane=function(){n.runCmd("cleane")};n.runCmd=function(n){u.post("Ajax/MatchFinding/ConsoleCommand?cmd="+n,{}).success(function(){alert("ok")}).error(function(n,t,i,r){alert(n);console.log(t);console.log(n);console.log(i);console.log(r)})}}]);sportApp.controller("MatchCreationController",["$scope","CommonService","MatchFindingService","TeamService",function(n,t,i){function r(){$("#modalSltProvince").select2();$("#modalPickerDropStartTimeInp").datetimepicker2({format:"d/m/Y H:i",defaultTime:"16:00",step:30,timepickerScrollbar:!1});$("#modalSltContract").select2({placeholder:"Chọn kèo",tags:!0});$("#modalSltLevel").select2({placeholder:"Chọn trình độ",tags:!1,createSearchChoice:function(){return!1}})}n.matchFindingRequest={typeId:1,countryId:1,provinceId:"3",countyId:null,stadiumIds:[],startTime:null,endTime:null,numberOfWeeksRepeat:"0",contract:"",ageGroupIds:[],levelIds:[],message:""};n.init=function(){i.getMatchCreationFormData().then(function(t){n.myTeams=t.teams;n.listLevels=t.levels;n.listProvinces=t.provinces;n.hasTeams=t.teams!=null&&t.teams.length>0;n.matchFindingRequest.partnerTeamLevel=t.levels[0];n.hasTeams&&(n.matchFindingRequest.teamId=n.myTeams[0].id+"",setTimeout(function(){r()}));n.isLoadedMatchCreationForm=!0})};n.onCreateMatchFindingReqest=function(t){n.matchFindingRequest.clientStadiumList=$('[idd="modalSltStadiumMultiple"] option:selected').map(function(){return{id:this.value,text:this.text}}).toArray();n.matchFindingRequest.clientAreaList=$('[idd="modalSltClientAreaMultiple"] option:selected').map(function(){return{id:this.value,text:this.text}}).toArray();var r=$('[idd="modalSltStadium"]').val();(isNaN(r)?(n.matchFindingRequest.stadiumId=null,n.matchFindingRequest.stadiumName=r):(n.matchFindingRequest.stadiumId=parseInt(r),n.matchFindingRequest.stadiumName=null),n.matchFindingRequest.status=$("#create-match-status").length>0?parseInt($("#create-match-status").val()):1,n.matchFindingCreationErrors="",$("#modalPickerDropStartTimeInp").val()===""&&(n.matchFindingCreationErrors="Bạn chưa chọn thời gian <br>"),n.matchFindingRequest.status===2?isNaN(n.matchFindingRequest.stadiumId)&&(n.matchFindingRequest.stadiumName==null||n.matchFindingRequest.stadiumName==="")&&(n.matchFindingCreationErrors+="Bạn chưa chọn sân bóng <br>"):(n.matchFindingRequest.hasStadium?isNaN(n.matchFindingRequest.stadiumId)&&(n.matchFindingRequest.stadiumName==null||n.matchFindingRequest.stadiumName==="")&&(n.matchFindingCreationErrors+="Bạn chưa chọn sân bóng <br>"):(n.matchFindingRequest.clientCountyIdList==null||n.matchFindingRequest.clientCountyIdList.length===0)&&(n.matchFindingRequest.clientAreaList==null||n.matchFindingRequest.clientAreaList.length===0)&&(n.matchFindingCreationErrors+="Bạn chưa chọn khu vực hoặc sân bóng  <br>"),(n.matchFindingRequest.message==null||n.matchFindingRequest.message==="")&&(n.matchFindingCreationErrors+="Bạn chưa nhập lời nhắn <br>")),n.matchFindingCreationErrors==="")&&(n.matchFindingRequest.startTime=moment($("#modalPickerDropStartTimeInp").val(),"DD/MM/YYYY HH:mm").toDate().toISOString(),common.ui.showLoading(),$(t.toElement).button("loading"),i.makeMatchFindingRequest(n.matchFindingRequest).then(function(i){if(i.isSuccessful)common.ui.modal.hide("commonModal"),n.matchFindingRequest={},common.ui.notification.success("Mời đối thành công.!"),location.href="/match/"+i.id;else{var r=i.errors[0].message;r==""&&(r="Không tạo được lời mời đối.!");common.ui.notification.error(r)}$(t.toElement).button("reset");common.ui.hideLoading()}))}}]);sportApp.controller("MatchInvitationController",["$scope","$rootScope","MatchFindingService","TeamService",function(n,t,i,r){n.inviteTeamId=0;n.hasMatchFindingRequest=!1;n.listMatchFindingRequest=[];n.isReady=!1;n.matchDisplaySettings={showFullInfo:!1,hideStatus:!0,showBtnDoi:!0};n.filter={isOwner:!0,typeId:1,pageIndex:1,pageSize:3,countryId:1};n.init=function(){n.goToPage(1);var t=$("#hidInviteFromMatchFindingId").val()!==""?parseInt($("#hidInviteFromMatchFindingId").val()):0;t>0?i.getMobileNumbers(t).then(function(t){n.activeMatchRequestMobileNo=t.data}):r.getTeamMobileNo($("#hidInviteTeamId").val()).then(function(t){n.activeMatchRequestMobileNo=t.data})};n.goToPage=function(t){n.filter.pageIndex=t;common.ui.showLoading();i.getMyMatchFindingRequests(n.filter).then(function(t){t!==null&&(n.listMatchFindingRequest=t.records.filter(function(n){return n.hasStadium}),n.hasMatchFindingRequest=n.listMatchFindingRequest.length>0);common.ui.hideLoading();n.isReady=!0})};n.createNewMatch=function(n){showAngularJsModalByBtn(n.toElement)};n.selectMatchToInvite=function(t){n.inviteTeamId=parseInt($("#hidInviteTeamId").val());var r={matchFindingRequestIdList:[t.id],teamId:n.inviteTeamId,toMatchFindingId:$("#hidInviteFromMatchFindingId").val()!==""?parseInt($("#hidInviteFromMatchFindingId").val()):0,message:"isOwnerInvite",isOwnerInvite:!0};common.ui.showLoading();i.makeMatchInvitation(r).then(function(i){common.ui.hideLoading();i.isSuccessful?(t.activeInvitedTeamIds.push(n.inviteTeamId),common.ui.notification.success("Đã gửi lời mờ, vui lòng đợi đối xác nhận.")):common.ui.notification.error("Lỗi. Vui lòng gửi lại.")})};n.isBtnInviteVisible=function(n){var i=parseInt($("#hidInviteTeamId").val()),t=$("#hidInviteFromMatchFindingId").val()!==""?parseInt($("#hidInviteFromMatchFindingId").val()):0;return n.activeInvitedTeamIds.indexOf(i)>=0?!1:t>0&&n.activeToMatchRequestIds.indexOf(t)>=0?!1:!0}}]);sportApp.controller("MatchInvitationMultiPartnersController",["$scope","$rootScope","MatchFindingService","TeamService","CommonService",function(n,t,i,r,u){var f=this,e;f.teamDisplaySettings={hideChat:!0};e={id:0,name:"Tất cả trình độ"};f.matchFindingRequestId=0;f.teamList=[];f.matchRequestList=[];f.isReady=!1;f.fromTeamId=0;f.filter={typeId:1,pageIndex:1,pageSize:5,countryId:1,ReturnTeamsCreatedByOwnersOnly:!0,selectedLevel:e,loadInvitedMatchRequestIds:!0};f.init=function(n,t,i){u.getAllCommonItems("level").then(function(n){f.listLevels=n.records;f.listLevels.splice(0,0,e)});f.matchFindingRequestId=t;f.filter.inviteToMatchRequestId=t;f.filter.provinceId=i;f.fromTeamId=n;r.searchTeams(f.filter).then(function(n){f.teamList=n.records;f.isReady=!0})};f.searchTeams=function(){typeof f.filter.selectedLevel!="undefined"&&(f.filter.levelId=f.filter.selectedLevel.id);r.searchTeams(f.filter).then(function(n){f.teamList=n.records;f.isReady=!0})};f.goToPage=function(n){f.filter.pageIndex=n;f.searchTeams()};f.inviteTeam=function(n){var t={matchFindingRequestIdList:[f.matchFindingRequestId],teamId:n.id,message:"isOwnerInvite",isOwnerInvite:!0};common.ui.showLoading();i.makeMatchInvitation(t).then(function(){n.activeInvitedFromTeamIds.push(f.fromTeamId);common.ui.hideLoading();common.ui.notification.success("Đã gửi lời mờ, vui lòng đợi đối xác nhận.")})};f.onQuickChat=function(n){t.onQuickChat(n)}}]);sportApp.controller("MatchRecipientMakerController",["$scope","CommonService","MatchFindingService","TeamService",function(n,t,i){n.activeMatchRequestToRecipientId=null;n.matchFindingRecipient={id:0,teamId:null,message:null};n.init=function(t){n.myLeadTeams=angular.copy(common.config.myTeams);n.myLeadTeams.push({id:"0",name:"Thêm đội mới..."});i.getMobileNumbers(t).then(function(t){n.matchMobileNo=t.data});common.ui.showLoading();i.getUserMatchFindingRecipient(t).then(function(i){i.data!=null&&(n.matchFindingRecipient=i.data);n.activeMatchRequestToRecipientId=t;i.data!=null&&i.data.toTeamId!=null?n.matchFindingRecipient.teamId=i.data.toTeamId+"":n.myLeadTeams.length>0&&(n.matchFindingRecipient.teamId=n.myLeadTeams[0].id+"");n.isReady=!0;common.ui.hideLoading()})};n.onMakeMatchFindingRecipient=function(t){var r,f,u;if(formValid("formMatchFindingRecipientCreate")){if(n.matchFindingRecipient.teamId=$("#modalMakerSltTeam").val(),n.activeMatchRequestToRecipientId!=null)n.matchFindingRecipient.matchFindingRequestIdList=[n.activeMatchRequestToRecipientId];else if(r=n.getCheckedMatchFindingList(),r!=null&&r.length>0){for(f=[],u=0;u<r.length;u++)f.push(r[u].id);n.matchFindingRecipient.matchFindingRequestIdList=f}else{alert("Check vào Chọn đặt kèo để chọn nhanh hơn.");return}$(t.toElement).button("loading");i.makeMatchInvitation(n.matchFindingRecipient).then(function(n){n.isSuccessful?(common.ui.notification.success("Gửi nhận kèo thành công "+n.totalRecord+" đối. Vui lòng đợi đối xác nhận."),location.reload()):common.ui.notification.error(n.message)})}}}]);sportApp.controller("MatchFindingQueueController",["$scope","$rootScope","$http","$timeout","$interval","MatchFindingQueueService",function(n,t,i,r,u,f){function o(){$(".q-container .queue-timer").each(function(){var n=$(this),t=parseFloat(n.attr("remaining-minutes")),i=n.attr("waiting-minutes");t>0&&startTimer(t*60,n,function(){n.html("Đối không trả lời sau "+i+" phút")})})}var e=this;e.queueOfMatchInProgress=!0;e.queueOfTeamInProgress=!0;e.matchDisplaySettings={showFullInfo:!1,hideStatus:!0,showBtnDoi:!0};e.matchDisplaySettings2={showFullInfo:!1,showBtnDoi:!0};e.teamDisplaySettings={hideBtnInvite:!0,hideAbout:!0};e.loadQueuesOfMatchItems=function(){f.getQueuesOfMatchItems().then(function(n){e.queuesOfMatchItems=n.data;e.queueOfMatchInProgress=!1;setTimeout(function(){o()},1e3)})};e.loadQueuesOfTeamItems=function(){f.getQueuesOfTeamItems().then(function(n){e.queuesOfTeamItems=n.data;e.queueOfTeamInProgress=!1;setTimeout(function(){o()},1e3)})};e.onQuickChat=function(n){t.onQuickChat(n)};e.loadQueuesOfMatchItems();e.loadQueuesOfTeamItems()}])